/* Mobile and Small Screens (up to 768px) */
@media (max-width: 768px) {
    /* Base Layout */
    body {
        padding: 0;
        margin: 0;
        min-height: 100vh;
        overflow: hidden;
        font-size: 16px;
        overflow-x: hidden;
    }

    /* Lobby Screen */
    .lobby-screen {
        padding: 1rem;
    }

    /* Logo Adjustments */
    .game-logo {
        margin: 1rem auto;
    }

    .logo-image {
        width: 100px;
        height: 100px;
    }

    .game-logo .hit {
        font-size: 3.5rem;
    }

    /* Menu Buttons */
    .lobby-button {
        font-size: 1rem;
        padding: 0.75rem 1.25rem;
        min-width: 200px;
    }

    .lobby-input {
        font-size: 1rem;
        padding: 0.75rem;
    }

    /* Game Container Layout */
    .game-container {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        border-radius: 0;
    }

    /* Header Styling */
    .game-header {
        height: 60px;
        padding: 0.5rem 1rem;
        border-radius: 0;
        height: auto;
        flex-direction: column;
        align-items: center;
    }

    .header-left, .header-right {
        width: 100%;
        justify-content: center;
        margin-bottom: 0.5rem;
    }

    .header-left .game-logo {
        font-size: 2rem;
    }

    .game-header .game-code-display {
        flex-direction: column;
        align-items: center;
    }

    .game-header .game-code-display .label {
        font-size: 1rem;
    }

    .header-right .game-button {
        font-size: 0.8rem;
        padding: 0.5rem 1rem;
    }

    /* Deck Area - Updated */
    .deck-area {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        z-index: 10; /* Reduced z-index */
        padding: 0.5rem;
        background: var(--secondary);
        max-height: 100px; /* Limit height */
        overflow-y: auto;
        margin-bottom: 0.5rem;
    }

    .deck-info {
        font-size: 1rem;
        padding: 0.5rem;
    }

    .deck-count {
        font-size: 1rem;
        padding: 0.5rem;
    }

    /* Players Container - Updated */
    .players-container {
        margin-top: 160px; /* Header + Deck Area */
        margin-bottom: 80px; /* Controls height */
        padding: 0.5rem;
        gap: 0.5rem;
        overflow-y: auto;
        max-height: calc(100vh - 230px);
        position: relative;
        z-index: 20; /* Higher than deck area */
        flex-direction: column;
        overflow-x: auto;
    }

    /* Player Cards - Updated */
    .player {
        min-width: calc(100vw - 2rem);
        margin: 0 0 0.5rem 0;
        padding: 1rem;
        position: relative;
        z-index: 25; /* Higher than container */
        background: var(--secondary); /* Ensure background is solid */
        min-width: 90vw;
        max-width: 90vw;
        margin: 0.5rem auto;
        padding: 0.75rem;
        border-radius: 10px;
    }

    .player.current-turn {
        border: 2px solid var(--highlight);
        order: -1; /* Force current player to top */
    }

    .scores {
        grid-template-columns: repeat(3, 1fr);
        gap: 0.25rem;
        padding: 0.5rem;
    }

    .score-box {
        padding: 0.5rem;
        font-size: 0.75rem;
    }

    .score-value {
        font-size: 1rem;
    }

    .player-status {
        font-size: 0.8rem;
        padding: 0.5rem;
    }

    .status-icon {
        font-size: 1.2rem;
    }

    .status-text {
        font-size: 0.7rem;
    }

    .busted-card {
        font-size: 0.7rem;
    }

    /* Cards Grid */
    .card-grid {
        grid-template-columns: repeat(7, 35px);
        gap: 0.25rem;
        padding: 0.25rem;
        justify-content: center;
    }

    .card, .empty-slot {
        width: 35px;
        height: 49px;
        font-size: 0.8rem;
    }

    /* Special Cards */
    .special-cards-container {
        gap: 0.25rem;
        padding: 0.5rem;
    }

    .card.special {
        width: 35px;
        height: 49px;
        font-size: 0.8rem;
    }

    /* Controls - Updated */
    .controls {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px;
        padding: 0.5rem;
        background: var(--secondary);
        border-top: 2px solid var(--highlight);
        z-index: 30; /* Highest z-index */
        display: flex;
        justify-content: space-around;
        align-items: center;
    }

    .game-button {
        height: 45px;
        padding: 0 1.5rem;
        font-size: 0.9rem;
        min-width: 100px;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        min-width: auto;
    }

    /* Popups */
    .winner-popup,
    .round-summary-popup,
    .freeze-popup,
    .draw-three-popup,
    .tutorial-popup {
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        max-width: 90%;
        max-height: 80vh;
        padding: 1rem;
        border-radius: 15px;
    }

    .winner-popup h2,
    .round-summary-popup h2,
    .freeze-popup h3,
    .draw-three-popup h3 {
        font-size: 1.5rem;
    }

    .tutorial-popup .tutorial-section h2 {
        font-size: 1.2rem;
    }

    .cards-grid {
        grid-template-columns: 1fr;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }

    .card-example {
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .card-example .card {
        margin-bottom: 0.5rem;
    }

    .card-explanation {
        font-size: 0.75rem;
    }

    /* Waiting Screen */
    .waiting-screen {
        width: 90%;
        padding: 1.5rem;
        max-width: 90%;
        padding: 1rem;
        border-radius: 15px;
    }

    .waiting-screen h2 {
        font-size: 1.5rem;
    }

    .waiting-screen .players-list {
        max-height: 150px;
    }

    .waiting-screen .player-item {
        font-size: 0.8rem;
    }

    .waiting-screen .share-section {
        flex-direction: column;
        align-items: center;
    }

    .waiting-screen .share-text {
        font-size: 0.9rem;
    }

    .share-link-input {
        width: 100%;
        margin-bottom: 0.5rem;
    }

    /* Remaining Pile */
    .remaining-info {
        flex-direction: column;
        align-items: center;
    }

    .remaining-pile {
        width: 100%;
    }

    .remaining-card {
        width: 40px;
        height: 56px;
        font-size: 0.8rem;
    }
}

/* Tablet Optimization (768px - 1024px) */
@media (min-width: 769px) and (max-width: 1024px) {
    .players-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-top: 160px;
    }

    .player {
        min-width: 0;
        width: auto;
    }

    .player.current-turn {
        grid-column: 1 / -1;
    }
}

/* Landscape Mode Optimization */
@media (max-width: 1024px) and (orientation: landscape) {
    .players-container {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        margin-top: 120px;
        margin-bottom: 80px;
    }

    .deck-area {
        padding: 0.3rem;
    }

    .controls {
        height: 60px;
    }

    .game-button {
        height: 40px;
    }
}

/* High-DPI Screen Optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .game-container,
    .player,
    .deck-area,
    .controls {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
    }
}

/* Fallback for devices without backdrop-filter support */
@supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
    .game-container,
    .player,
    .deck-area,
    .controls {
        background: rgba(22, 33, 62, 0.95);
    }
}

/* Small Tablets (Landscape) */
@media (max-width: 900px) and (orientation: landscape) {
    .players-container {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
    }

    .player {
        min-width: 45%;
        max-width: 45%;
    }
}
